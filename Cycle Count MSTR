SELECT H.COUNT_NUMBER,
L.REGION,
L.AREA,
H.OFFICE_FULL_NAME,
H.COUNT_BY,
H.COUNT_DATE,
H.STATUS,
R.VENDOR_NAME,
P.VENDOR_PART_NUM,
P.PART_DESC,
T.ONHAND_QTY,
T.COUNT_QTY,
T.ONHAND_QTY - T.COUNT_QTY as DELTA,
ABS(T.ONHAND_QTY - T.COUNT_QTY) as ABS_DELTA,
(P.PRICE * (T.ONHAND_QTY - T.COUNT_QTY)) as ADJ_COST,
ABS((P.PRICE * (T.ONHAND_QTY - T.COUNT_QTY))) as ABS_COST,
P.PRICE,
(P.PRICE * T.ONHAND_QTY) as ONHAND_VALUE,
(P.PRICE * T.COUNT_QTY) as COUNT_VALUE,
CASE WHEN T.ONHAND_QTY - T.COUNT_QTY = 0 THEN 0 ELSE 1 END AS Part_#,
C.CATEGORY_1,
C.CATEGORY_2,
C.CATEGORY_3,
P.COUNT_CLASSIFICATION
FROM INVENTORY.MV_SNAP_COUNT_HEADERS H,
INVENTORY.MV_SNAP_COUNT_LINES T,
INVENTORY.MV_PARTS P,
INVENTORY.MV_LOCATIONS L,
INVENTORY.MV_VENDORS R,
INVENTORY.MV_PARTS_CATEGORY C
WHERE T.PART_ID = P.PART_ID
AND T.COUNT_ID = H.COUNT_ID
AND R.VENDOR_ID = P.VENDOR_ID
AND H.LOCATION_ID = L.LOCATION_ID
AND C.CATEGORY_ID = P.CATEGORY_ID
AND H.COUNT_DATE > '01-JAN-17'
--AND H.COUNT_DATE < '31-MAR-17'
AND H.STATUS = 'Closed'
ORDER BY H.COUNT_NUMBER ASC;
